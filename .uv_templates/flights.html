{% extends 'base.html' %}

{% block head %}
  <title>Open Flight Log – Flights History</title>
{% endblock %}

{% block body %}

<div class="container-fluid mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Flight History</h2>
  </div>

  <div class="table-responsive" style="overflow-x: auto; max-height: 80vh;">
    <table class="table table-bordered table-hover table-sm text-nowrap">
      <thead class="table-dark sticky-top">
        <tr>
          <th>#</th>
          <th>Date</th>
          <th>Departure</th>
          <th>Arrival</th>
          <th>Aircraft Type</th>
          <th>Registration</th>
          <th>SP Type</th>
          <th>MP Time</th>
          <th>Total Time</th>
          <th>PIC Name</th>
          <th>Landings D/N</th>
          <th>Night</th>
          <th>IFR</th>
          <th>PIC Time</th>
          <th>Co-Pilot</th>
          <th>Dual</th>
          <th>Instructor</th>
          <th>FSTD</th>
          <th>FSTD Time</th>
          <th>Remarks</th>
        </tr>
      </thead>
      <tbody>
        {% if rows %}
          {% for row in rows %}
          <tr>
            <td>{{ row.id }}</td>
            <td>{{ row.date }}</td>
            <td>
              <strong>{{ row.dept_place }}</strong><br>
              <small class="text-muted">{{ row.dept_time }}</small>
            </td>
            <td>
              <strong>{{ row.arrv_place }}</strong><br>
              <small class="text-muted">{{ row.arrv_time }}</small>
            </td>
            <td>{{ row.aircraft_type or '—' }}</td>
            <td>{{ row.aircraft_registration or '—' }}</td>
            <td>{{ row.single_pilot_time or '—' }}</td>
            <td>{{ row.multi_pilot_time or '—' }}</td>
            <td><strong>{{ row.total_flight_time}}</strong></td>
            <td>{{ row.pilot_in_command }}</td>
            <td>{{ row.landings_day or 0 }}/{{ row.landings_night or 0 }}</td>
            <td>{{ row.oct_night or '—' }}</td>
            <td>{{ row.oct_ifr or '—' }}</td>
            <td>{{ row.pft_pic or '—' }}</td>
            <td>{{ row.pft_copilot or '—' }}</td>
            <td>{{ row.pft_dual or '—' }}</td>
            <td>{{ row.pft_instructor or '—' }}</td>
            <td>
              {% if row.fstd_date %}
                {{ row.fstd_date }}<br>
                <small>{{ row.fstd_type }}</small>
              {% else %}
                —
              {% endif %}
            </td>
            <td>{{ row.fstd_total_time_sess or '—' }}</td>
            <td>{{ row.remarks or '' }}</td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="20" class="text-center text-muted py-5">
              <p class="mb-2">No flights recorded yet.</p>
              <a href="/flights/add" class="btn btn-sm btn-outline-primary">Add Your First Flight</a>
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}